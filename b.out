Training input paths:
Training input paths:
data/sunrgbd/SUNRGBD/metadata.csv
Input settings:
n_batch=2  n_height=256  n_width=256
data/sunrgbd/SUNRGBD/metadata.csv

Input settings:
n_batch=2  n_height=256  n_width=256

Network settings:
model_architecture=resnet
Weight settings:
n_parameter=29908929

Network settings:
Training settings:
model_architecture=resnet
n_sample=6201  n_epoch=40  n_step=124040
Weight settings:
scheduler type: multi_step
n_parameter=29908929

scheduler: multi_step, learning_schedule=[0-46500 : 0.0002, 46500-77500 : 0.0001, 77500-108500 : 5e-05, 108500-124000 : 2e-05]
Training settings:

n_sample=6201  n_epoch=40  n_step=124040
Loss function settings:
scheduler type: multi_step
w_weight_decay=1.0e-04
scheduler: multi_step, learning_schedule=[0-46500 : 0.0002, 46500-77500 : 0.0001, 77500-108500 : 5e-05, 108500-124000 : 2e-05]


Checkpoint settings:
Loss function settings:checkpoint_path=checkpoints

w_weight_decay=1.0e-04checkpoint_save_frequency=1000


validation_start_step=5000
Checkpoint settings:

checkpoint_path=checkpoints
Tensorboard settings:
checkpoint_save_frequency=1000
event_path=checkpoints/tensorboard
validation_start_step=5000
log_summary_frequency=500  n_sample_per_summary=32  

restore_path=checkpoints/checkpoints/depth_segmentation_model-6000.pth
Tensorboard settings:

event_path=checkpoints/tensorboard
Hardware settings:
log_summary_frequency=500  n_sample_per_summary=32  
device=cuda
restore_path=checkpoints/checkpoints/depth_segmentation_model-6000.pth
n_thread=8

Hardware settings:

device=cuda
n_thread=8

Begin training...
[Val] [Step 6000] Top-1 pixel accuracy (equiv): 0.5250
[Val] [Step 6000] Top-k pixel accuracy (equiv): 0.8303
[Val] [Step 6000] Top-1 mIoU (equiv): 0.1643
[Val] [Step 6000] Top-k mIoU (equiv): 0.6045
[Val] Step 6000 | # of labels in Top-1 mIoU: 878
[Val] Step 6000 | # of labels in Top-k mIoU: 878
[Val] Step 6000 | Loss: 2.1065, Contrastive: 2.0016
Best validation loss: 2.1065 at step 6000
Begin training...
Rank 1 | Epoch 1 | Step 6193 | Loss : 0.25864571537532954 | LR: 0.0002
Rank 0 | Epoch 1 | Step 6193 | Loss : 0.27247097370229234 | LR: 0.0002
Rank 1 | Epoch 2 | Step 6386 | Loss : 0.2669255604552481 | LR: 0.0002
Rank 0 | Epoch 2 | Step 6386 | Loss : 0.2600260556439044 | LR: 0.0002
[Val] [Step 6500] Top-1 pixel accuracy (equiv): 0.5208
[Val] [Step 6500] Top-k pixel accuracy (equiv): 0.8291
[Val] [Step 6500] Top-1 mIoU (equiv): 0.1650
[Val] [Step 6500] Top-k mIoU (equiv): 0.6184
[Val] Step 6500 | # of labels in Top-1 mIoU: 877
[Val] Step 6500 | # of labels in Top-k mIoU: 877
[Val] Step 6500 | Loss: 2.0963, Contrastive: 2.0002
Best validation loss: 2.0963 at step 6500
Rank 0 | Epoch 3 | Step 6579 | Loss : 0.25960675190767474 | LR: 0.0002
Rank 1 | Epoch 3 | Step 6579 | Loss : 0.2554276242002922 | LR: 0.0002
Rank 0 | Epoch 4 | Step 6772 | Loss : 0.25454057058213286 | LR: 0.0002
Rank 1 | Epoch 4 | Step 6772 | Loss : 0.2540709201844863 | LR: 0.0002
Rank 1 | Epoch 5 | Step 6965 | Loss : 0.24444139559651903 | LR: 0.0002
Rank 0 | Epoch 5 | Step 6965 | Loss : 0.251754744682905 | LR: 0.0002
[Val] [Step 7000] Top-1 pixel accuracy (equiv): 0.5321
[Val] [Step 7000] Top-k pixel accuracy (equiv): 0.8385
[Val] [Step 7000] Top-1 mIoU (equiv): 0.1686
[Val] [Step 7000] Top-k mIoU (equiv): 0.6232
[Val] Step 7000 | # of labels in Top-1 mIoU: 875
[Val] Step 7000 | # of labels in Top-k mIoU: 875
[Val] Step 7000 | Loss: 2.0238, Contrastive: 1.9281
Best validation loss: 2.0238 at step 7000
Step=  7000/130040  Loss=0.2454958  Time Elapsed=0.49h  Time Remaining=60.87h
Rank 1 | Epoch 6 | Step 7158 | Loss : 0.24647192371323937 | LR: 0.0002
Rank 0 | Epoch 6 | Step 7158 | Loss : 0.24391297362937828 | LR: 0.0002
Rank 1 | Epoch 7 | Step 7351 | Loss : 0.23510154560594362 | LR: 0.0002
Rank 0 | Epoch 7 | Step 7351 | Loss : 0.23930975084477757 | LR: 0.0002
[Val] [Step 7500] Top-1 pixel accuracy (equiv): 0.5410
[Val] [Step 7500] Top-k pixel accuracy (equiv): 0.8463
[Val] [Step 7500] Top-1 mIoU (equiv): 0.1810
[Val] [Step 7500] Top-k mIoU (equiv): 0.6553
[Val] Step 7500 | # of labels in Top-1 mIoU: 876
[Val] Step 7500 | # of labels in Top-k mIoU: 876
[Val] Step 7500 | Loss: 1.9675, Contrastive: 1.8733
Best validation loss: 1.9675 at step 7500
Rank 1 | Epoch 8 | Step 7544 | Loss : 0.24601422786867064 | LR: 0.0002
Rank 0 | Epoch 8 | Step 7544 | Loss : 0.23011029681547937 | LR: 0.0002
Rank 1 | Epoch 9 | Step 7737 | Loss : 0.2263780930730963 | LR: 0.0002
Rank 0 | Epoch 9 | Step 7737 | Loss : 0.23641601888163719 | LR: 0.0002
Rank 1 | Epoch 10 | Step 7930 | Loss : 0.22898922084681111 | LR: 0.0002
Rank 0 | Epoch 10 | Step 7930 | Loss : 0.235885959408135 | LR: 0.0002
[Val] [Step 8000] Top-1 pixel accuracy (equiv): 0.5410
[Val] [Step 8000] Top-k pixel accuracy (equiv): 0.8490
[Val] [Step 8000] Top-1 mIoU (equiv): 0.1879
[Val] [Step 8000] Top-k mIoU (equiv): 0.6597
[Val] Step 8000 | # of labels in Top-1 mIoU: 876
[Val] Step 8000 | # of labels in Top-k mIoU: 876
[Val] Step 8000 | Loss: 1.9612, Contrastive: 1.8638
Best validation loss: 1.9612 at step 8000
Step=  8000/130040  Loss=0.2163058  Time Elapsed=0.98h  Time Remaining=59.70h
Rank 1 | Epoch 11 | Step 8123 | Loss : 0.23079811982385853 | LR: 0.0002
Rank 0 | Epoch 11 | Step 8123 | Loss : 0.23395322846161887 | LR: 0.0002
Rank 0 | Epoch 12 | Step 8316 | Loss : 0.22794965168200626 | LR: 0.0002
Rank 1 | Epoch 12 | Step 8316 | Loss : 0.22937477966818784 | LR: 0.0002
[Val] [Step 8500] Top-1 pixel accuracy (equiv): 0.5484
[Val] [Step 8500] Top-k pixel accuracy (equiv): 0.8522
[Val] [Step 8500] Top-1 mIoU (equiv): 0.1918
[Val] [Step 8500] Top-k mIoU (equiv): 0.6580
[Val] Step 8500 | # of labels in Top-1 mIoU: 880
[Val] Step 8500 | # of labels in Top-k mIoU: 880
[Val] Step 8500 | Loss: 1.9257, Contrastive: 1.8357
Best validation loss: 1.9612 at step 8000
Rank 1 | Epoch 13 | Step 8509 | Loss : 0.22265902231085485 | LR: 0.0002
Rank 0 | Epoch 13 | Step 8509 | Loss : 0.2269124118852492 | LR: 0.0002
Rank 1 | Epoch 14 | Step 8702 | Loss : 0.2241066650251033 | LR: 0.0002
Rank 0 | Epoch 14 | Step 8702 | Loss : 0.22493999621256647 | LR: 0.0002
Rank 0 | Epoch 15 | Step 8895 | Loss : 0.21934297580484283 | LR: 0.0002
Rank 1 | Epoch 15 | Step 8895 | Loss : 0.2194194156734437 | LR: 0.0002
[Val] [Step 9000] Top-1 pixel accuracy (equiv): 0.5577
[Val] [Step 9000] Top-k pixel accuracy (equiv): 0.8572
[Val] [Step 9000] Top-1 mIoU (equiv): 0.2032
[Val] [Step 9000] Top-k mIoU (equiv): 0.7019
[Val] Step 9000 | # of labels in Top-1 mIoU: 882
[Val] Step 9000 | # of labels in Top-k mIoU: 882
[Val] Step 9000 | Loss: 1.9009, Contrastive: 1.8075
Best validation loss: 1.9009 at step 9000
Step=  9000/130040  Loss=0.2016905  Time Elapsed=1.43h  Time Remaining=57.71h
Rank 1 | Epoch 16 | Step 9088 | Loss : 0.20952801927538114 | LR: 2e-05
Rank 0 | Epoch 16 | Step 9088 | Loss : 0.20438117225089839 | LR: 2e-05
Rank 1 | Epoch 17 | Step 9281 | Loss : 0.20092808331695863 | LR: 2e-05
Rank 0 | Epoch 17 | Step 9281 | Loss : 0.19382988252324762 | LR: 2e-05
Rank 0 | Epoch 18 | Step 9474 | Loss : 0.20494754882674143 | LR: 2e-05
Rank 1 | Epoch 18 | Step 9474 | Loss : 0.19821986031038155 | LR: 2e-05
[Val] [Step 9500] Top-1 pixel accuracy (equiv): 0.5604
[Val] [Step 9500] Top-k pixel accuracy (equiv): 0.8590
[Val] [Step 9500] Top-1 mIoU (equiv): 0.2163
[Val] [Step 9500] Top-k mIoU (equiv): 0.7047
[Val] Step 9500 | # of labels in Top-1 mIoU: 886
[Val] Step 9500 | # of labels in Top-k mIoU: 886
[Val] Step 9500 | Loss: 1.8966, Contrastive: 1.8000
Best validation loss: 1.8966 at step 9500
Rank 1 | Epoch 19 | Step 9667 | Loss : 0.20395741986178365 | LR: 2e-05
Rank 0 | Epoch 19 | Step 9667 | Loss : 0.20705966693904115 | LR: 2e-05
Rank 1 | Epoch 20 | Step 9860 | Loss : 0.19689837005471936 | LR: 2e-05
Rank 0 | Epoch 20 | Step 9860 | Loss : 0.20469383818189096 | LR: 2e-05
[Val] [Step 10000] Top-1 pixel accuracy (equiv): 0.5551
[Val] [Step 10000] Top-k pixel accuracy (equiv): 0.8565
[Val] [Step 10000] Top-1 mIoU (equiv): 0.2179
[Val] [Step 10000] Top-k mIoU (equiv): 0.6974
[Val] Step 10000 | # of labels in Top-1 mIoU: 889
[Val] Step 10000 | # of labels in Top-k mIoU: 889
[Val] Step 10000 | Loss: 1.9137, Contrastive: 1.8147
Best validation loss: 1.8966 at step 9500
Step= 10000/130040  Loss=0.2101408  Time Elapsed=1.88h  Time Remaining=56.50h
Rank 0 | Epoch 21 | Step 10053 | Loss : 0.20685167838409158 | LR: 2e-05
Rank 1 | Epoch 21 | Step 10053 | Loss : 0.19750139974250694 | LR: 2e-05
Rank 1 | Epoch 22 | Step 10246 | Loss : 0.1989582956918163 | LR: 2e-05
Rank 0 | Epoch 22 | Step 10246 | Loss : 0.19865208011062652 | LR: 2e-05
Rank 1 | Epoch 23 | Step 10439 | Loss : 0.1904641156871393 | LR: 2e-05
Rank 0 | Epoch 23 | Step 10439 | Loss : 0.20727647867999546 | LR: 2e-05
[Val] [Step 10500] Top-1 pixel accuracy (equiv): 0.5551
[Val] [Step 10500] Top-k pixel accuracy (equiv): 0.8578
[Val] [Step 10500] Top-1 mIoU (equiv): 0.2184
[Val] [Step 10500] Top-k mIoU (equiv): 0.7085
[Val] Step 10500 | # of labels in Top-1 mIoU: 890
[Val] Step 10500 | # of labels in Top-k mIoU: 890
[Val] Step 10500 | Loss: 1.9225, Contrastive: 1.8220
Best validation loss: 1.9225 at step 10500
Rank 0 | Epoch 24 | Step 10632 | Loss : 0.2037693344712875 | LR: 2e-05
Rank 1 | Epoch 24 | Step 10632 | Loss : 0.19132990888054507 | LR: 2e-05
Rank 1 | Epoch 25 | Step 10825 | Loss : 0.19652073108470502 | LR: 2e-05
Rank 0 | Epoch 25 | Step 10825 | Loss : 0.19653390818926955 | LR: 2e-05
[Val] [Step 11000] Top-1 pixel accuracy (equiv): 0.5533
[Val] [Step 11000] Top-k pixel accuracy (equiv): 0.8546
[Val] [Step 11000] Top-1 mIoU (equiv): 0.2219
[Val] [Step 11000] Top-k mIoU (equiv): 0.7047
[Val] Step 11000 | # of labels in Top-1 mIoU: 886
[Val] Step 11000 | # of labels in Top-k mIoU: 886
[Val] Step 11000 | Loss: 1.9305, Contrastive: 1.8287
Best validation loss: 1.9225 at step 10500
Step= 11000/130040  Loss=0.1984695  Time Elapsed=2.33h  Time Remaining=55.59h
Rank 1 | Epoch 26 | Step 11018 | Loss : 0.19474888874767976 | LR: 2.0000000000000003e-06
Rank 0 | Epoch 26 | Step 11018 | Loss : 0.19822085135341308 | LR: 2.0000000000000003e-06
Rank 0 | Epoch 27 | Step 11211 | Loss : 0.18189644827049012 | LR: 2.0000000000000003e-06
Rank 1 | Epoch 27 | Step 11211 | Loss : 0.20362229687716676 | LR: 2.0000000000000003e-06
Rank 1 | Epoch 28 | Step 11404 | Loss : 0.1935172838211986 | LR: 2.0000000000000003e-06
Rank 0 | Epoch 28 | Step 11404 | Loss : 0.18945412862795005 | LR: 2.0000000000000003e-06
[Val] [Step 11500] Top-1 pixel accuracy (equiv): 0.5521
[Val] [Step 11500] Top-k pixel accuracy (equiv): 0.8553
[Val] [Step 11500] Top-1 mIoU (equiv): 0.2163
[Val] [Step 11500] Top-k mIoU (equiv): 0.6977
[Val] Step 11500 | # of labels in Top-1 mIoU: 892
[Val] Step 11500 | # of labels in Top-k mIoU: 892
[Val] Step 11500 | Loss: 1.9415, Contrastive: 1.8372
Best validation loss: 1.9225 at step 10500
Rank 1 | Epoch 29 | Step 11597 | Loss : 0.19231962211854717 | LR: 2.0000000000000003e-06
Rank 0 | Epoch 29 | Step 11597 | Loss : 0.18493030119899642 | LR: 2.0000000000000003e-06
Rank 1 | Epoch 30 | Step 11790 | Loss : 0.18976804629508695 | LR: 2.0000000000000003e-06
Rank 0 | Epoch 30 | Step 11790 | Loss : 0.195542390173581 | LR: 2.0000000000000003e-06
Rank 0 | Epoch 31 | Step 11983 | Loss : 0.18820385441878917 | LR: 2.0000000000000003e-06
Rank 1 | Epoch 31 | Step 11983 | Loss : 0.18448971084516902 | LR: 2.0000000000000003e-06
[Val] [Step 12000] Top-1 pixel accuracy (equiv): 0.5574
[Val] [Step 12000] Top-k pixel accuracy (equiv): 0.8570
[Val] [Step 12000] Top-1 mIoU (equiv): 0.2152
[Val] [Step 12000] Top-k mIoU (equiv): 0.6999
[Val] Step 12000 | # of labels in Top-1 mIoU: 891
[Val] Step 12000 | # of labels in Top-k mIoU: 891
[Val] Step 12000 | Loss: 1.9208, Contrastive: 1.8168
Best validation loss: 1.9225 at step 10500
Step= 12000/130040  Loss=0.1886907  Time Elapsed=2.79h  Time Remaining=54.84h
Rank 1 | Epoch 32 | Step 12176 | Loss : 0.193855540238205 | LR: 2.0000000000000003e-06
Rank 0 | Epoch 32 | Step 12176 | Loss : 0.1843236497183538 | LR: 2.0000000000000003e-06
Rank 0 | Epoch 33 | Step 12369 | Loss : 0.18770731854315248 | LR: 2.0000000000000003e-06
Rank 1 | Epoch 33 | Step 12369 | Loss : 0.19538370573922142 | LR: 2.0000000000000003e-06
[Val] [Step 12500] Top-1 pixel accuracy (equiv): 0.5546
[Val] [Step 12500] Top-k pixel accuracy (equiv): 0.8556
[Val] [Step 12500] Top-1 mIoU (equiv): 0.2165
[Val] [Step 12500] Top-k mIoU (equiv): 0.6994
[Val] Step 12500 | # of labels in Top-1 mIoU: 901
[Val] Step 12500 | # of labels in Top-k mIoU: 901
[Val] Step 12500 | Loss: 1.9410, Contrastive: 1.8367
Best validation loss: 1.9225 at step 10500
Rank 0 | Epoch 34 | Step 12562 | Loss : 0.19297520414844077 | LR: 2.0000000000000003e-06
Rank 1 | Epoch 34 | Step 12562 | Loss : 0.19062409032657357 | LR: 2.0000000000000003e-06
Rank 1 | Epoch 35 | Step 12755 | Loss : 0.19761173604683555 | LR: 2.0000000000000003e-06
Rank 0 | Epoch 35 | Step 12755 | Loss : 0.19343224735303247 | LR: 2.0000000000000003e-06
Rank 1 | Epoch 36 | Step 12948 | Loss : 0.18995761496878658 | LR: 2.0000000000000004e-07
Rank 0 | Epoch 36 | Step 12948 | Loss : 0.19904945983787892 | LR: 2.0000000000000004e-07
[Val] [Step 13000] Top-1 pixel accuracy (equiv): 0.5551
[Val] [Step 13000] Top-k pixel accuracy (equiv): 0.8560
[Val] [Step 13000] Top-1 mIoU (equiv): 0.2230
[Val] [Step 13000] Top-k mIoU (equiv): 0.7074
[Val] Step 13000 | # of labels in Top-1 mIoU: 896
[Val] Step 13000 | # of labels in Top-k mIoU: 896
[Val] Step 13000 | Loss: 1.9349, Contrastive: 1.8295
Best validation loss: 1.9225 at step 10500
Step= 13000/130040  Loss=0.1937394  Time Elapsed=3.24h  Time Remaining=54.16h
Rank 1 | Epoch 37 | Step 13141 | Loss : 0.18943880795660414 | LR: 2.0000000000000004e-07
Rank 0 | Epoch 37 | Step 13141 | Loss : 0.19093810203316297 | LR: 2.0000000000000004e-07
Rank 1 | Epoch 38 | Step 13334 | Loss : 0.19180387088671866 | LR: 2.0000000000000004e-07
Rank 0 | Epoch 38 | Step 13334 | Loss : 0.19222169936938607 | LR: 2.0000000000000004e-07
[Val] [Step 13500] Top-1 pixel accuracy (equiv): 0.5520
[Val] [Step 13500] Top-k pixel accuracy (equiv): 0.8543
[Val] [Step 13500] Top-1 mIoU (equiv): 0.2169
[Val] [Step 13500] Top-k mIoU (equiv): 0.7021
[Val] Step 13500 | # of labels in Top-1 mIoU: 895
[Val] Step 13500 | # of labels in Top-k mIoU: 895
[Val] Step 13500 | Loss: 1.9403, Contrastive: 1.8365
Best validation loss: 1.9225 at step 10500
Rank 1 | Epoch 39 | Step 13527 | Loss : 0.19050541666814083 | LR: 2.0000000000000004e-07
Rank 0 | Epoch 39 | Step 13527 | Loss : 0.18471163901177096 | LR: 2.0000000000000004e-07
Rank 0 | Epoch 40 | Step 13720 | Loss : 0.1881646791501984 | LR: 2.0000000000000004e-07
Step= 13720/13720  Loss=36.3157831  Time Elapsed=3.56h  Time Remaining=0.00h
Rank 1 | Epoch 40 | Step 13720 | Loss : 0.18814096310286943 | LR: 2.0000000000000004e-07
